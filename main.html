<!DOCTYPE html>
<html>
<head>
  <title>My Private Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  Dashboard Pribadi
</header>

<div class="container">

  <div class="card col-6">
    <h3>Status Hari Ini</h3>
    <!-- status -->
  </div>

  <div class="card col-6">
    <h3>Agenda</h3>
    <!-- agenda -->
  </div>

  <div class="card col-4">
    <h3>Jurnal</h3>
    <!-- jurnal -->
  </div>

  <div class="card col-4">
    <h3>Ringkasan</h3>
    <!-- weekly -->
  </div>

  <div class="card col-4">
    <h3>Catatan</h3>
    <!-- bebas -->
  </div>

</div>
<script>
  if (sessionStorage.getItem("auth") !== "true") {
    window.location.href = "index.html";
  }

  document.getElementById("date").innerText =
    new Date().toLocaleDateString("id-ID", {
      weekday: "long",
      year: "numeric",
      month: "long",
      day: "numeric"
    });

  document.getElementById("journal").value =
    localStorage.getItem("journal") || "";

  function saveJournal() {
    localStorage.setItem(
      "journal",
      document.getElementById("journal").value
    );
    document.getElementById("saved").innerText = "Tersimpan ✔";
  }

  function logout() {
    sessionStorage.clear();
    window.location.href = "index.html";
  }

  let agendas = JSON.parse(localStorage.getItem("agendas")) || [];

function renderAgenda() {
  const list = document.getElementById("agendaList");
  list.innerHTML = "";

  agendas.forEach((a, i) => {
    const li = document.createElement("li");
    li.innerHTML = `
      ${a.text}<br>
      <small>${new Date(a.time).toLocaleString("id-ID")}</small><br>
      <button onclick="setAlarm('${a.text}','${a.time}')">⏰ Set Alarm</button>
      <button onclick="deleteAgenda(${i})">❌</button>
    `;
    list.appendChild(li);
  });

  localStorage.setItem("agendas", JSON.stringify(agendas));
}

function addAgenda() {
  const text = document.getElementById("agendaText").value;
  const time = document.getElementById("agendaTime").value;
  if (!text || !time) return;

  agendas.push({ text, time });
  renderAgenda();

  document.getElementById("agendaText").value = "";
  document.getElementById("agendaTime").value = "";
}

function deleteAgenda(i) {
  agendas.splice(i, 1);
  renderAgenda();
}

function setAlarm(title, time) {
  const start = new Date(time).toISOString().replace(/-|:|\.\d+/g,"");
  const end = start;

  const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${start}/${end}`;

  window.open(url, "_blank");
}

renderAgenda();

  // load status
document.getElementById("statusToday").value =
  localStorage.getItem("statusToday") || "";

function todayKey() {
  const d = new Date();
  return `status-${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
}

window.onload = function () {
  const key = todayKey();
  document.getElementById("statusToday").value =
    localStorage.getItem(key) || "";
};

function saveStatus() {
  const key = todayKey();
  const val = document.getElementById("statusToday").value;
  localStorage.setItem(key, val);
  document.getElementById("statusSaved").innerText =
    "Status hari ini tersimpan ✔";
}

  function renderWeekly() {
  const ul = document.getElementById("weeklySummary");
  ul.innerHTML = "";

  for (let i = 6; i >= 0; i--) {
    const d = new Date();
    d.setDate(d.getDate() - i);

    const key = `status-${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
    const text = localStorage.getItem(key);

    const li = document.createElement("li");
    li.innerHTML = `<strong>${d.toLocaleDateString("id-ID")}</strong>: 
      ${text || "<em>(kosong)</em>"}`;
    ul.appendChild(li);
  }
}

renderWeekly();
</script>

</body>
</html>
